[Oracle教程](http://www.hechaku.com/Oracle/oracle_sql_plus.html)

[常用命令](https://www.cnblogs.com/chinafine/articles/1755405.html)

[oracle函数]（https://www.cnblogs.com/lxl57610/p/7442130.html）

**sys用户和system用户**  
- sys用户是超级用户，具有最高权限，具有sysdba角色，有create database的权限  
- system用户是管理操作员，权限也很大。具有sysoper角色，没有create database的权限  

##  sql语句注意点
- select name,distinct year from users;
语句执行失败，因为左边和右边行数不匹配
- oracle中字符串用单引号''隔开，这点与MySQL不同
- 日期操作常用to_char(date,'yyyy-mm-dd'),不容易出错
- like '_%xxxxx',用于模糊查询， _ 替代一个字符，%替代0到n个字符
- 字符使用转义字符，name like '_\_aa' escape '\'  , \ _就能代表'_'
- 密码必须以字母开头，如果以数字开头，它不会创建用户

**profile**  
>profile是口令限制，资源限制的命令集合，当建立数据库时，oracle会自动建立名称为default的profile。  
当建立用户没有指定profile选项时，那么oracle就会将default分配给用户  

set timing on/off;  
打开显示操作时间的开关，在底部显示操作时间。

nvl(string1, replace_with) 　　
功能：如果string1为null，则nvl函数返回replace_with的值，否则返回string1的值。  

查找1982.1.1后入职的员工？ select ename,hiredate from emp where hiredate >'1-1 月-1982';  


最高工资那个人是谁？

	`错误写法`：select ename, sal from emp where sal=max(sal);
	`正确写法`：select ename, sal from emp where sal=(select max(sal) from emp);
	`注意`：select ename, max(sal) from emp;这语句执行的时候会报错，说ora-00937：非单组  
  分组函数。因为max是分组函数，而ename不是分组函数.......

**但是select min(sal), max(sal) from emp;这句是可以执行的。因为min和max都是分组函数，就是说：
如果列里面有一个分组函数，其它的都必须是分组函数，否则就出错。这是语法规定的**
  
  如何显示每个部门的平均工资和最高工资？  
	select avg(sal), max(sal), deptno from emp group by deptno;
  
  显示每个部门的每种岗位的平均工资和最低工资？  
	select min(sal), avg(sal), deptno, job from emp group by deptno, job;
  
  分组函数总结：
  * 顺序是group by, having, order by 
  * 分组函数只能出现在选择列表、having、order by子句中(不能出现在where中)
  * 选择列中如果有列、表达式和分组函数，那么这些列和表达式必须有一个出现在group by 子句中
  
 当在from子句中使用子查询时，该子查询会被作为一个视图来对待，因此叫做内嵌视图，  
 当在from 子句中使用子查询时，必须给子查询指定别名。 注意：别名不能用as，
 
 `事务的几个重要操作`    
* 1.设置保存点 savepoint a
* 2.取消部分事务 rollback to a
* 3.取消全部事务 rollback

设置只读事务: set transaction read only;  
在设置了只读事务后，尽管其它会话可能会提交新的事务，但是只读事务将不会取得最新数据的变化，从而可以保证取得特定时间点的数据信息。

`字符串函数`  
* lower(char)：将字符串转化为小写的格式。  
* upper(char)：将字符串转化为大写的格式。  
* length(char)：返回字符串的长度。  
* substr(char, m, n)：截取字符串的子串，n代表取n个字符的意思，不是代表取到第n个  
* replace(char1, search_string, replace_string)  
* instr(C1,C2,I,J) -->判断某字符或字符串是否存在，存在返回出现的位置的索引，否则返回小于1;在一个字符串中搜索指定的字符,返回发现指定的字符的位置;  
	** C1 被搜索的字符串  
	** C2 希望搜索的字符串  
	** I 搜索的开始位置,默认为1  
	** J 出现的位置,默认为1  

`数学函数`  
* round(n,[m]) 该函数用于执行四舍五入  
* trunc(n,[m]) 该函数用于截取数字。  
* mod(m,n)取余函数  
* floor(n) 返回小于或是等于n的最大整数
* ceil(n) 返回大于或是等于n的最小整数
* abs(n) 返回数字n的绝对值

`oracle add_months函数`
* oracle add_months(time,months)函数可以得到某一时间之前或之后n个月的时间

value(num) oracle的自动转换函数，将num转为合适的数据类型  
to_char()函数  
eg to_char(hiredate, 'mm')=12  （12月份）  

**sys_context()系统函数** 
* 1)terminal：当前会话客户所对应的终端的标示符，如计算机名 
* 2)language: 语言 
* 3)db_name： 当前数据库名称 
* 4)nls_date_format： 当前会话客户所对应的日期格式 
* 5)session_user： 当前会话客户所对应的数据库用户名 
* 6)current_schema： 当前会话客户所对应的默认方案名 
* 7)host： 返回数据库所在主机的名称 通过该函数，可以查询一些重要信息，比如你正在使用哪个数据库？   
select sys_context('USERENV','db_name') from dual;   
注意：USERENV是固定的，不能改的，db_name可以换成其它,   
eg、select sys_context('USERENV','language') from dual;   
select sys_context('USERENV','current_schema') from dual;


## 备份
物理备份即可在数据库open的状态下进行也可在关闭数据库后进行，但是逻辑备份和恢复只能在open的状态下进行  

导出使用exp命令来完成的，该命令常用的选项有：  
* userid：用于指定执行导出操作的用户名，口令，连接字符串  
* tables：用于指定执行导出操作的表  
* owner：用于指定执行导出操作的方案  
* full=y：用于指定执行导出操作的数据库  
* inctype：用于指定执行导出操作的增量类型  
* rows：用于指定执行导出操作是否要导出表中的数据  
* file：用于指定导出文件名   

`特别说明-->在导入和导出的时候，要到oracle目录的bin目录下。`

Oracle 的 oracle逻辑备份与恢复

## oracle字典和性能视图  
普通用户不能直接访问数据字典的基表,可以通过查询数据字典视图取得系统信息  
数据字典视图主要包括user_xxx，all_xxx，dba_xxx三种类型

* user_tables: 用于显示`当前用户所拥有的所有表`，它只返回用户所对应方案的所有表
* all_tables: 用于显示`当前用户可以访问的所有表`，它不仅会返回当前用户方案的所有表，  
还会返回当前用户可以访问的其它方案的表
* dba_tables: 它会显示`所有方案拥有的数据库表`。但是查询这种数据库字典视图，  
要求用户必须是`dba角色`或是有`select any table 系统权限`

## 用户名，权限，角色
在建立用户时，oracle会把用户的信息存放到数据字典中，当给用户授予权限或是角色时，  
oracle会将权限和角色的信息存放到数据字典

* dba_users可以显示所有数据库用户的详细信息；
* 数据字典视图dba_sys_privs，可以显示用户所具有的系统权限；
* 数据字典视图dba_tab_privs，可以显示用户具有的对象权限；
* 数据字典dba_col_privs 可以显示用户具有的列权限；
* 数据库字典视图dba_role_privs 可以显示用户所具有的角色。

**oracle的所有动态性能视图都是以v_$开始的，并且oracle为每个动态性能视图都提供了相应的同义词，并且其同义词是以V$开始的**

